<%= render :partial => 'layouts/sidebar' %>


<!-- Script code for preview generation. Credit: https://www.spencerdixon.com/blog/image-preview-with-carrierwave-and-rails.html -->
<script>
$(function() {
  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();

      reader.onload = function (e) {
        $('#editProfilePicture').attr('src', e.target.result);
      }
      reader.readAsDataURL(input.files[0]);
    }
  }

  $("#newProfilePicture").change(function(){
    $('#editProfilePicture').removeClass('hidden');
    readURL(this);
  });
});
</script>

<div class="container">
  <div class="row">

    <div class="col-md-offset-2">
      <div class="editProfilePictureBlock">
        <%= image_tag(@user.picture.url, id: "editProfilePicture", class: "img-thumbnail") %>

        <%= form_for @user do |f| %>

          <%= f.file_field :picture, id:"newProfilePicture" %>
          <%= f.submit "Submit New Profile Picture",
                class:"btn btn-md btn-default", style: "margin-top: 5px;", name: 'change_picture' %>
        <% end %>
      </div>
    </div>

    <div class="col-md-offset-4 col-md-7">
      <div class="editProfileBlock">

        <h1>Edit Profile</h1>
        <%= form_for @user do |f| %>

          <%= f.label :name, "New Username" %>
          <%= f.text_field :name, class: "form-control" %>

          <%= f.submit "Submit New Username", class:"btn btn-md btn-default",
                  style: "float: right; margin-top: 5px;", name: 'change_username' %><br><br>


          <%= f.label :email, "New Email" %>
          <%= f.email_field :email, class: "form-control" %>

          <%= f.submit "Submit New Email", class:"btn btn-md btn-default",
                  style: "float: right; margin-top: 5px;", name: 'change_email' %><br><br>


          <%= f.label :password, "New Password" %>
          <%= f.password_field :password, class: "form-control" %><br>

          <%= f.label :password_confirmation, "Confirm New Password" %>
          <%= f.password_field :password_confirmation, class: "form-control" %>

          <%= f.submit "Submit New Password", class:"btn btn-md btn-default",
                  style: "float: right; margin-top: 5px;", name: 'change_password' %><br><br><br>

        <% end %>

        <%= link_to "< Back to Profile", @user, style: "display: block; float: right;" %>

        <!--<%= link_to "Change Email", "#", class: "btn btn-default btn-lg"%><br>
        <%= link_to "Change Profile Picture", "#", class: "btn btn-default btn-lg"%><br>
        <%= link_to "Change Password", "#", class: "btn btn-default btn-lg" %>-->
      </div>
    </div>
  </div>
</div>
